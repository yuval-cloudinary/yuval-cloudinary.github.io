!function(){"use strict";var e=self.console,t=Object.freeze({NONE:0,ERROR:1,WARN:2,INFO:3,LOG:4}),n=["error","warn","info","log"],r=void 0!==e&&void 0!==e.log&&void 0!==e.error&&void 0!==e.debug&&void 0!==e.warn&&"function"==typeof Function.prototype.apply,o=void 0,i=void 0,a=function(t,n,r,o){return e[n]?r?e[n](r):e[n]():t.log("----------- "+(r||o)+" ----------- ")},l=function(t){var i=t.level,l={setLevel:function(e){return i=e,l},getLevel:function(){return i||o}};return n.forEach(function(t){l[t]=function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return function(t,o,i){if(r){var a=n.indexOf(o),l=t.getLevel();return~a&&l>=a+1&&e[o].apply(e,i),t}}(l,t,i)}}),l.groupCollapsed=function(e){return a(l,"groupCollapsed",e,"GROUP START")},l.group=function(e){return a(l,"group",e,"GROUP START")},l.groupEnd=function(){return a(l,"groupEnd",null,"GROUP END")},l.debug=l.log,l},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.level=e.level||t.NONE;var n=e.newInstance||!i?l(e):i;return i||e.newInstance||(i=n),n},u="ML_WIDGET_INIT",d="ML_WIDGET_SHOW",c="ML_WIDGET_HIDE",f="ML_WIDGET_INSERT_DATA",p=["cloud_name","api_key","username","timestamp","signature"],g=["cms_type","inline_container","z_index","multiple","max_files","default_transformations","insert_caption","remove_header","folder","search","collection","asset","transformation"],v=s(),m=function(e,t){var n=void 0,r=Array.isArray(t.allowedOrigin)?t.allowedOrigin:[t.allowedOrigin],o=t.types,i=function(e){if(!e||!e.length)throw"PostMessage - target not set!"},a=function(e){if(~r.indexOf(e.origin)){n=e.origin;var i=function(e,t){var n=null;try{n="string"==typeof e?JSON.parse(e):e}catch(e){v.error("[postmessage]: failed to parse data from "+t,e)}return n}(e.data,e.origin);i&&(t.validator&&!t.validator(i.data)||i.type&&o[i.type]&&(v.log("[postmessage]: found matching handler for '"+i.type+"' event from: "+e.origin,i.data),o[i.type](i.data,i.type,e,t)))}};return i(r),self.addEventListener("message",a,!1),{send:function(t,r){var o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).target||n;i(o);try{v.log("[postmessage]: posting message to: "+o),e instanceof HTMLIFrameElement&&(e=e.contentWindow),e.postMessage(JSON.stringify({type:t,data:r}),o)}catch(e){v.error("[postmessage]: failed to post message to target: "+o,e)}},close:function(){return self.removeEventListener("message",a)}}},y=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};s();!function(e){var n,r=0;e.location.search.indexOf("debug=true")>-1&&(n=t.LOG,o=n);var i=function(t,n,o){var i=void 0,a=void 0,l=null,s=!1,v=!1,b=!!t.inline_container,w="",_="ml_"+r;r+=1;var E,O,L,I,A,M,x,N=function(e){27===e.keyCode&&P.hide()},T=function(){var e=[];return e.push("pmHost="+self.location.protocol+"//"+self.location.host),e.push("new_cms=true"),e.push("ml_id="+_),p.filter(function(e){return Boolean(t[e])}).forEach(function(n){return e.push(n+"="+encodeURIComponent(t[n]))}),e},H=function(e){window.requestAnimationFrame(function(){a.style.padding=e.matches?"25px":"25px 0"})},R=function(e){var t=b?i:a;(function(e){var t=document.body;if(b&&"string"==typeof(t=e.inline_container)&&(t=document.querySelector(t)),!t)throw"Element Not Found ("+e.inline_container+")";return t})(e).appendChild(t),i.focus()},S=function(){var t=b?i:a;v&&s?(t.style.visibility="visible",t.focus(),!b&&e.document.addEventListener("keyup",N)):(t.style.visibility="hidden",e.document.removeEventListener("keyup",N))},k=function(){v=!0,S()},D=function(){!b&&document.body&&(w=document.body.style.overflow,document.body.style.overflow="hidden"),s=!0,S()},G=function(){!b&&document.body&&(document.body.style.overflow=w),s=!1,S()};M=h({},t),x=function(e){var t=T(),n=void 0;return{origin:"https://"+(n=!0===e.dev?"dev.cloudinary.com":(!0===e.staging?"staging.":"")+"cloudinary.com"),href:"https://"+n+"/console/media_library/cms?"+t.join("&")}}(M),M.mlUrl=x,M.callbacks=n,o&&(E="string"==typeof(L=o)?document.querySelector(L):L,O=e.document.createElement("button"),E.style.display="none",O.setAttribute("class",t.button_class||"cloudinary-button"),O.innerHTML=t.button_caption||"Open Media Library",E.parentNode.insertBefore(O,E.previousSibling),O.addEventListener("click",function(e){return D(),e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),!1},!1)),function(n){var r=n.mlUrl;if((i=e.document.createElement("iframe")).setAttribute("src",r.href),i.setAttribute("frameborder","no"),i.setAttribute("allow","camera"),b?(i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.style.border="none"):(i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.style.boxShadow="0 0 50px rgba(0, 0, 0, 0.8)"),!b){if((a=e.document.createElement("div")).style.position="fixed",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%",a.style.boxSizing="border-box",a.style.backgroundColor="rgba(0,0,0,0.5)",a.style.zIndex=t.z_index||99999,matchMedia){var o=window.matchMedia("(min-width: 700px)");o.addListener(H),H(o)}a.style.visibility="hidden",a.appendChild(i)}}(M),l=function(e){return new Promise(function(t,n){var r,o=m(e.ifr,{validator:function(t){return t&&t.mlId&&t.mlId===e.mlId},allowedOrigin:e.mlUrl.origin,types:(r={},y(r,f,function(t){e.callbacks.insertHandler(t)}),y(r,c,function(){e.callbacks.hideHandler()}),r)}),i=function(t,n){o.send(t,n,{target:e.mlUrl.origin})};e.ifr.addEventListener("load",function(){i(u,e),e.iframeLoaded(),t({sendMessage:i})}),e.ifr.addEventListener("error",function(){})})}({ifr:i,mlId:_,mlUrl:x,callbacks:h({},n,{insertHandler:b?n.insertHandler:function(e){n.insertHandler(e),G()},hideHandler:G}),iframeLoaded:k,config:(I=M,A=g,A.reduce(function(e,t){return void 0!==I[t]?h({},e,y({},t,I[t])):e},{}))}),R(M);var P={show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.then(function(t){t.sendMessage(d,{mlId:_,options:h({},e,{config:e}),config:e}),D()}),this},hide:function(){return l.then(function(e){e.sendMessage(c,{mlId:_}),G()}),this}};return P};e.cloudinary=e.cloudinary||{},e.cloudinary.openMediaLibrary=function(e,t,n){return i(e,t,n).show()},e.cloudinary.createMediaLibrary=function(e,t,n){return i(e,t,n)}}(self)}();